{%- assign date_format = site.yat.date_format | default: "%b %-d, %Y" -%}

{%- assign article = post.content -%}
{%- assign lang = post.lang -%}
{%- include functions.html func='get_reading_time' -%}
{%- assign reading_time = return -%}

{%- include functions.html func='get_article_excerpt' -%}
{%- assign article_excerpt = return -%}
{%- assign post_url = post.url | relative_url -%}

{%- assign name = 'excerpt.image_width' -%}
{%- include functions.html func='get_value' -%}
{%- assign image_width = return | default: '38.2%' -%}

{%- assign name = 'excerpt.image_height' -%}
{%- include functions.html func='get_value' -%}
{%- assign image_height = return | default: '160px' -%}

{%- assign name = 'excerpt.default_image' -%}
{%- include functions.html func='get_value' -%}
{%- assign default_image = return -%}

{%- assign post_image = post.excerpt_image
  | default: post.banner.image
  | default: post.banner
  | default: default_image
  | default: '/assets/images/default-image.jpeg' -%}

<li class="post-item {{ post_item_class }}" data-categories="{{ post.categories | join: ',' }}">
  <a href="{{ post_url }}" class="post-item-link">
    <div class="post-content-area">
      <div class="post-author-info">
        <img src="{{ site.author_info.avatar | default: '/assets/images/profile-avatar.jpeg' }}" 
             alt="Author Avatar" 
             class="author-avatar">
        <span class="author-name">
          {%- if post.author -%}
          {{ post.author | escape }}
          {%- else -%}
          {{ site.author | escape }}
          {%- endif -%}
        </span>
        
      </div>
      <h2 class="post-title">
        {{ post.title | escape }}
        {%- assign post_lang = post.lang | default: site.lang | default: 'ko' -%}
        {%- if post_lang == 'en' -%}
          &nbsp;&nbsp;<span class="header-badge badge-lang" title="English Post">ðŸ‡ºðŸ‡¸ EN</span>
        {%- elsif post_lang == 'ko' -%}
          &nbsp;&nbsp;<span class="header-badge badge-lang" title="Korean Post">ðŸ‡°ðŸ‡· KO</span>
        {%- endif -%}
        {%- include views/post-badges.html -%}
      </h2>
      <div class="post-subtitle">
        {% if post.subtitle %}{{ post.subtitle | escape }}{% else %}{{ article_excerpt }}{% endif %}
      </div>
      <div class="post-meta-info">
        <span class="post-date">{{ post.date | date: date_format }}</span>
        <span class="post-reading-time">{{ reading_time }}</span>
        <div class="post-tags-area">
          {%- for tag in post.tags -%}
          <span class="post-tag">{{ tag }}</span>
          {%- endfor -%}
        </div>
      </div>
    </div>
    {%- if post_image and post_image != 'NO_EXCERPT_IMAGE' -%}
    <div class="post-thumbnail">
      <img src="{{ post_image | relative_url }}" alt="{{ post.title | escape }}">
    </div>
    {%- endif -%}
  </a>
</li>
